option(PDFWRITER_SUPPORT_JPG "Wether or not JPEG/DCT support is enabled" TRUE)
option(PDFWRITER_SUPPORT_PNG "Wether or not PNG support is enabled" TRUE)
option(PDFWRITER_SUPPORT_TIFF "Wether or not TIFF support is enabled" TRUE)

find_package(ZLIB REQUIRED)
find_package(Freetype REQUIRED)

if(PDFWRITER_SUPPORT_JPG)
    find_package(JPEG REQUIRED)
else()
	add_definitions(-DPDFHUMMUS_NO_DCT=1)
endif()

if(PDFWRITER_SUPPORT_TIFF)
    find_package(TIFF REQUIRED)
else()
	add_definitions(-DPDFHUMMUS_NO_TIFF=1)
endif()

if(PDFWRITER_SUPPORT_PNG)
    find_package(PNG REQUIRED)
else()
	add_definitions(-DPDFHUMMUS_NO_PNG=1)
endif()


set(PDF_WRITER_SOURCE
    # IO Source
    io/ArrayOfInputStreamsStream.cpp
    io/InputAESDecodeStream.cpp
    io/InputAscii85DecodeStream.cpp
    io/InputAsciiHexDecodeStream.cpp
    io/InputBufferedStream.cpp
    io/InputByteArrayStream.cpp
    io/InputCharStringDecodeStream.cpp
    io/InputDCTDecodeStream.cpp
    io/InputFile.cpp
    io/InputFileStream.cpp
    io/InputFlateDecodeStream.cpp
    io/InputLZWDecodeStream.cpp
    io/InputLimitedStream.cpp
    io/InputRC4XcodeStream.cpp
    io/InputPFBDecodeStream.cpp
    io/InputPredictorPNGOptimumStream.cpp
    io/InputPredictorTIFFSubStream.cpp
    io/InputStreamSkipperStream.cpp
    io/InputStringBufferStream.cpp
    io/InputStringStream.cpp
    io/OutputAESEncodeStream.cpp
    io/OutputBufferedStream.cpp
    io/OutputFile.cpp
    io/OutputFileStream.cpp
    io/OutputFlateDecodeStream.cpp
    io/OutputFlateEncodeStream.cpp
    io/OutputRC4XcodeStream.cpp
    io/OutputStreamTraits.cpp
    io/OutputStringBufferStream.cpp

    # Images
    images/jpeg/JPEGImageHandler.cpp
    images/jpeg/JPEGImageInformation.cpp
    images/jpeg/JPEGImageParser.cpp
    images/png/PNGImageHandler.cpp
    images/tiff/TIFFImageHandler.cpp
    images/tiff/TiffUsageParameters.cpp

    # Encryption
    encryption/MD5Generator.cpp
    encryption/RC4.cpp

    #sources
    AbstractContentContext.cpp
    AbstractWrittenFont.cpp
    ANSIFontWriter.cpp
    Ascii7Encoding.cpp
    CatalogInformation.cpp
    CFFANSIFontWriter.cpp
    CFFDescendentFontWriter.cpp
    CFFEmbeddedFontWriter.cpp
    CFFFileInput.cpp
    CFFPrimitiveReader.cpp
    CFFPrimitiveWriter.cpp
    CharStringType1Interpreter.cpp
    CharStringType1Tracer.cpp
    CharStringType2Flattener.cpp
    CharStringType2Interpreter.cpp
    CharStringType2Tracer.cpp
    CIDFontWriter.cpp
    CMYKRGBColor.cpp
    DecryptionHelper.cpp
    DescendentFontWriter.cpp
    DictionaryContext.cpp
    DocumentContext.cpp
    EncryptionHelper.cpp
    EncryptionOptions.cpp
    FontDescriptorWriter.cpp
    FreeTypeFaceWrapper.cpp
    FreeTypeOpenTypeWrapper.cpp
    FreeTypeType1Wrapper.cpp
    FreeTypeWrapper.cpp
    GraphicState.cpp
    GraphicStateStack.cpp
    IndirectObjectsReferenceRegistry.cpp
    InfoDictionary.cpp
    Log.cpp
    ObjectsContext.cpp
    OpenTypeFileInput.cpp
    OpenTypePrimitiveReader.cpp
    PageContentContext.cpp
    PageTree.cpp
    ParsedPrimitiveHelper.cpp
    PDFArray.cpp
    PDFBoolean.cpp
    PDFCosArray.cpp
    PDFCosDict.cpp
    PDFDate.cpp
    PDFDictionary.cpp
    PDFDocEncoding.cpp
    PDFDocumentCopyingContext.cpp
    PDFDocumentHandler.cpp
    PDFFormXObject.cpp
    PDFTiledPattern.cpp
    TiledPatternContentContext.cpp
    PDFHexString.cpp
    PDFImageXObject.cpp
    PDFIndirectObjectReference.cpp
    PDFInteger.cpp
    PDFLiteralString.cpp
    PDFModifiedPage.cpp
    PDFName.cpp
    PDFNull.cpp
    PDFObject.cpp
    PDFObjectParser.cpp
    PDFPage.cpp
    PDFPageInput.cpp
    PDFDictionaryIterator.cpp
    PDFArrayIterator.cpp
    PDFPageMergingHelper.cpp
    PDFParser.cpp
    PDFParserTokenizer.cpp
    PDFParsingOptions.cpp
    PDFReal.cpp
    PDFRectangle.cpp
    PDFStream.cpp
    PDFStreamInput.cpp
    PDFSymbol.cpp
    PDFTextString.cpp
    PDFUsedFont.cpp
    PDFWriter.cpp
    PFMFileReader.cpp
    PrimitiveObjectsWriter.cpp
    PSBool.cpp
    RefCountObject.cpp
    ResourcesDictionary.cpp
    SimpleStringTokenizer.cpp
    StandardEncoding.cpp
    StateReader.cpp
    StateWriter.cpp
    Timer.cpp
    TimersRegistry.cpp
    Trace.cpp
    TrailerInformation.cpp
    TrueTypeANSIFontWriter.cpp
    TrueTypeDescendentFontWriter.cpp
    TrueTypeEmbeddedFontWriter.cpp
    TrueTypePrimitiveWriter.cpp
    Type1Input.cpp
    Type1ToCFFEmbeddedFontWriter.cpp
    Type1ToType2Converter.cpp
    Type2CharStringWriter.cpp
    UnicodeString.cpp
    UppercaseSequance.cpp
    UsedFontsRepository.cpp
    WinAnsiEncoding.cpp
    WrittenFontCFF.cpp
    WrittenFontTrueType.cpp
    XCryptionCommon.cpp
    XObjectContentContext.cpp
)

set(PDF_WRITER_HEADERS
    # IO Headers
    io/ArrayOfInputStreamsStream.h
    io/InputAESDecodeStream.h
    io/InputAscii85DecodeStream.h
    io/InputAsciiHexDecodeStream.h
    io/InputBufferedStream.h
    io/InputByteArrayStream.h
    io/InputCharStringDecodeStream.h
    io/InputDCTDecodeStream.h
    io/InputFile.h
    io/InputFileStream.h
    io/InputFlateDecodeStream.h
    io/InputLZWDecodeStream.h
    io/InputLimitedStream.h
    io/InputRC4XcodeStream.h
    io/InputPFBDecodeStream.h
    io/InputPredictorPNGOptimumStream.h
    io/InputPredictorTIFFSubStream.h
    io/InputStreamSkipperStream.h
    io/InputStringBufferStream.h
    io/InputStringStream.h
    io/IOBasicTypes.h
    io/IReadPositionProvider.h
    io/OutputAESEncodeStream.h
    io/OutputBufferedStream.h
    io/OutputFile.h
    io/OutputFileStream.h
    io/OutputFlateDecodeStream.h
    io/OutputFlateEncodeStream.h
    io/OutputRC4XcodeStream.h
    io/OutputStreamTraits.h
    io/OutputStringBufferStream.h

    # Images
    images/jpeg/JPEGImageHandler.h
    images/jpeg/JPEGImageInformation.h
    images/jpeg/JPEGImageParser.h
    images/png/PNGImageHandler.h
    images/tiff/TIFFImageHandler.h
    images/tiff/TiffUsageParameters.h

    # Encryption
    encryption/MD5Generator.h
    encryption/RC4.h

    #headers
    AbstractContentContext.h
    AbstractWrittenFont.h
    ANSIFontWriter.h
    Ascii7Encoding.h
    BetweenIncluding.h
    BoxingBase.h
    CatalogInformation.h
    CFFANSIFontWriter.h
    CFFDescendentFontWriter.h
    CFFEmbeddedFontWriter.h
    CFFFileInput.h
    CFFPrimitiveReader.h
    CFFPrimitiveWriter.h
    CharStringDefinitions.h
    CharStringType1Interpreter.h
    CharStringType1Tracer.h
    CharStringType2Flattener.h
    CharStringType2Interpreter.h
    CharStringType2Tracer.h
    CIDFontWriter.h
    CMYKRGBColor.h
    ContainerIterator.h
    DecryptionHelper.h
    Deletable.h
    DescendentFontWriter.h
    DictionaryContext.h
    DictOperand.h
    DocumentContext.h
    DocumentContextExtenderAdapter.h
    EFontStretch.h
    EHummusImageType.h
    EncryptionHelper.h
    EncryptionOptions.h
    EPDFVersion.h
    EStatusCode.h
    ETokenSeparator.h
    FontDescriptorWriter.h
    FreeTypeFaceWrapper.h
    FreeTypeOpenTypeWrapper.h
    FreeTypeType1Wrapper.h
    FreeTypeWrapper.h
    FSType.h
    GlyphUnicodeMapping.h
    GraphicState.h
    GraphicStateStack.h
    IANSIFontWriterHelper.h
    IContentContextListener.h
    IDeletable.h
    IDescendentFontWriter.h
    IDocumentContextExtender.h
    IFontDescriptorHelper.h
    IFormEndWritingTask.h
    ITiledPatternEndWritingTask.h
    IFreeTypeFaceExtender.h
    IndirectObjectsReferenceRegistry.h
    InfoDictionary.h
    IObjectsContextExtender.h
    IPageEndWritingTask.h
    IPDFParserExtender.h
    IResourceWritingTask.h
    IType1InterpreterImplementation.h
    IType2InterpreterImplementation.h
    IWrittenFont.h
    Log.h
    MapIterator.h
    MyStringBuf.h
    ObjectsBasicTypes.h
    ObjectsContext.h
    ObjectsContextExtenderAdapter.h
    OpenTypeFileInput.h
    OpenTypePrimitiveReader.h
    PageContentContext.h
    PageTree.h
    ParsedPrimitiveHelper.h
    PDFArray.h
    PDFBoolean.h
    PDFCosArray.h
    PDFCosDict.h
    PDFDate.h
    PDFDictionary.h
    PDFDocEncoding.h
    PDFDocumentCopyingContext.h
    PDFDocumentHandler.h
    PDFEmbedParameterTypes.h
    PDFFormXObject.h
    PDFTiledPattern.h
    TiledPatternContentContext.h
    PDFHexString.h
    PDFImageXObject.h
    PDFIndirectObjectReference.h
    PDFInteger.h
    PDFLiteralString.h
    PDFModifiedPage.h
    PDFName.h
    PDFNull.h
    PDFObject.h
    PDFObjectCast.h
    PDFObjectParser.h
    PDFPage.h
    PDFPageInput.h
    PDFDictionaryIterator.h
    PDFArrayIterator.h
    PDFPageMergingHelper.h
    PDFParser.h
    PDFParserTokenizer.h
    PDFParsingOptions.h
    PDFReal.h
    PDFRectangle.h
    PDFStream.h
    PDFStreamInput.h
    PDFSymbol.h
    PDFTextString.h
    PDFUsedFont.h
    PDFWriter.h
    PFMFileReader.h
    PrimitiveObjectsWriter.h
    ProcsetResourcesConstants.h
    PSBool.h
    RefCountObject.h
    RefCountPtr.h
    ResourcesDictionary.h
    SafeBufferMacrosDefs.h
    SimpleStringTokenizer.h
    Singleton.h
    SingleValueContainerIterator.h
    StandardEncoding.h
    StateReader.h
    StateWriter.h
    Timer.h
    TimersRegistry.h
    Trace.h
    TrailerInformation.h
    TrueTypeANSIFontWriter.h
    TrueTypeDescendentFontWriter.h
    TrueTypeEmbeddedFontWriter.h
    TrueTypePrimitiveWriter.h
    Type1Input.h
    Type1ToCFFEmbeddedFontWriter.h
    Type1ToType2Converter.h
    Type2CharStringWriter.h
    UnicodeString.h
    UppercaseSequance.h
    UsedFontsRepository.h
    WinAnsiEncoding.h
    WrittenFontCFF.h
    WrittenFontRepresentation.h
    WrittenFontTrueType.h
    XCryptionCommon.h
    XObjectContentContext.h
)

add_library(PDFWriter ${PDF_WRITER_SOURCE} ${PDF_WRITER_HEADERS})

target_link_libraries(PDFWriter PRIVATE aes JPEG::JPEG ZLIB::ZLIB PNG::PNG TIFF::TIFF Freetype::Freetype)
target_include_directories(PDFWriter PUBLIC ${CMAKE_CURRENT_SOURCE_DIR})
target_include_directories(PDFWriter PUBLIC ${FREETYPE_INCLUDE_DIRS})